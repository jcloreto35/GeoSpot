<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

<head>
  <title>GeoSpot</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
</head>

<div id="header" style="background: rgb(65, 125, 146); display: flex; align-items: center;">
    <img src="geoSpot_sm.png" alt="Logo" id="logo" style="margin-right: 15px;">
    <span id="headerText" style="color: white; font-size: 22px; font-family: 'Bebas Neue', sans-serif; letter-spacing: 1px;"></span>

</div>

<style>
    #map {
        height: 600px;
        width: 100%;
    }

    #timer, #playTimer {
        position: absolute;
        top: 20px;
        left: 50%;
        transform: translateX(-50%);
        font-size: 40px;
        color: white;
        padding: 10px 20px;
        background: rgba(0,0,0,0.5);
        border-radius: 10px;
        display: none;
        z-index: 2000;
    }

    #btnApostar {
        position: absolute;
        bottom: 20px;
        left: 50%;
        transform: translateX(-50%);
        font-size: 24px;
        padding: 12px 25px;
        background: #007bff;
        color: white;
        border: none;
        border-radius: 12px;
        cursor: pointer;
        display: none;
        z-index: 9999; /* AGORA GARANTIDO */
    }
</style>

<div id="timer"></div>
<div id="playTimer"></div>

<button type="button" class="btn btn-default" id="btnApostar">
<table><tr><td style="width:30px">
      <span class="glyphicon glyphicon-search" style="color: white;"></span> </td><td> <h4 id="textoBotao" style="color: white;">Esse √© o ponto!</h4></td></tr></table>
    </button>
<div id="map"></div>

<script>
    let map;
    let marker;
    let countdownInterval;
    let zoomInterval;
    let playTimerRef;
    let jogoAtivo = false;

const mensagens = [
    "Prepare-se para o desafio!",
    "Ser√° que voc√™ acerta desta vez?",
    "Use seu instinto explorador!",
    "Adivinhe onde estou!",
    "Este lugar √© famoso‚Ä¶ ou n√£o!",
    "Confia no zoom!",
    "Olhe bem‚Ä¶ ou melhor, aproxime bem!",
    "Aposto que voc√™ j√° viu esse lugar!",
    "Seu mapa mental est√° em dia?",
    "S√≥ os fortes encontram!",
    "Vamos testar sua mem√≥ria geogr√°fica!",
    "Parece f√°cil? Veremos!",
    "N√£o vale chutar‚Ä¶ ou vale?",
    "Zoom para vencer!",
    "Hora da verdade!",
    "Boa sorte, detetive do GPS!"
];

function mensagemAleatoria() {
    return mensagens[Math.floor(Math.random() * mensagens.length)];
}

const pontosTuristicos = [
    { lat: 48.8584, lng: 2.2945, nome: mensagemAleatoria() },
    { lat: 40.6892, lng: -74.0445, nome: mensagemAleatoria() },
    { lat: 41.8902, lng: 12.4922, nome: mensagemAleatoria() },
    { lat: 51.5007, lng: -0.1246, nome: mensagemAleatoria() },
    { lat: 40.7580, lng: -73.9855, nome: mensagemAleatoria() },
    { lat: 25.1972, lng: 55.2744, nome: mensagemAleatoria() },
    { lat: 27.1751, lng: 78.0421, nome: mensagemAleatoria() },
    { lat: 29.9792, lng: 31.1342, nome: mensagemAleatoria() },
    { lat: 40.4319, lng: 116.5704, nome: mensagemAleatoria() },
    { lat: 35.6586, lng: 139.7454, nome: mensagemAleatoria() },
	{ lat: -13.1631, lng: -72.5450, nome: mensagemAleatoria() }, // Machu Picchu
{ lat: -22.9519, lng: -43.2105, nome: mensagemAleatoria() }, // Cristo Redentor
{ lat: -22.9068, lng: -43.1729, nome: mensagemAleatoria() }, // P√£o de A√ß√∫car
{ lat: -25.6953, lng: -54.4367, nome: mensagemAleatoria() }, // Cataratas do Igua√ßu
{ lat: -3.4653, lng: -62.2159, nome: mensagemAleatoria() }, // Amaz√¥nia
{ lat: -12.9747, lng: -38.4767, nome: mensagemAleatoria() }, // Pelourinho
{ lat: -8.0632, lng: -34.8711, nome: mensagemAleatoria() }, // Marco Zero Recife
{ lat: -15.7998, lng: -47.8645, nome: mensagemAleatoria() }, // Congresso Nacional
{ lat: -12.9016, lng: -38.3305, nome: mensagemAleatoria() }, // Farol da Barra
{ lat: -23.5505, lng: -46.6333, nome: mensagemAleatoria() }, // S√£o Paulo - Centro

{ lat: 43.7229, lng: 10.3966, nome: mensagemAleatoria() }, // Torre de Pisa
{ lat: 35.3606, lng: 138.7274, nome: mensagemAleatoria() }, // Monte Fuji
{ lat: 25.0343, lng: -77.3963, nome: mensagemAleatoria() }, // Nassau
{ lat: 37.7749, lng: -122.4194, nome: mensagemAleatoria() }, // S√£o Francisco
{ lat: 34.0522, lng: -118.2437, nome: mensagemAleatoria() }, // Los Angeles
{ lat: 51.1789, lng: -1.8262, nome: mensagemAleatoria() }, // Stonehenge
{ lat: 30.3285, lng: 35.4444, nome: mensagemAleatoria() }, // Petra
{ lat: 35.6895, lng: 139.6917, nome: mensagemAleatoria() }, // T√≥quio
{ lat: 38.7223, lng: -9.1393, nome: mensagemAleatoria() }, // Lisboa
{ lat: 37.9838, lng: 23.7275, nome: mensagemAleatoria() }, // Atenas

{ lat: 55.7558, lng: 37.6176, nome: mensagemAleatoria() }, // Moscou - Kremlin
{ lat: 59.9343, lng: 30.3351, nome: mensagemAleatoria() }, // S√£o Petersburgo
{ lat: 64.9631, lng: -19.0208, nome: mensagemAleatoria() }, // Isl√¢ndia
{ lat: 28.3852, lng: -81.5639, nome: mensagemAleatoria() }, // Disney World
{ lat: 20.6843, lng: -88.5678, nome: mensagemAleatoria() }, // Chich√©n Itz√°
{ lat: 21.4225, lng: 39.8262, nome: mensagemAleatoria() }, // Meca (Kaaba)
{ lat: 52.0790, lng: 4.3113, nome: mensagemAleatoria() }, // Haia
{ lat: 60.1699, lng: 24.9384, nome: mensagemAleatoria() }, // Helsinque
{ lat: 52.5200, lng: 13.4050, nome: mensagemAleatoria() }, // Berlim
{ lat: 50.0755, lng: 14.4378, nome: mensagemAleatoria() }, // Praga

{ lat: 41.0151, lng: 28.9795, nome: mensagemAleatoria() }, // Istambul
{ lat: 25.2048, lng: 55.2708, nome: mensagemAleatoria() }, // Dubai Marina
{ lat: -34.6037, lng: -58.3816, nome: mensagemAleatoria() }, // Buenos Aires
{ lat: -33.4489, lng: -70.6693, nome: mensagemAleatoria() }, // Santiago
{ lat: -22.9707, lng: -43.1830, nome: mensagemAleatoria() }, // Copacabana
{ lat: -34.9205, lng: -57.9536, nome: mensagemAleatoria() }, // La Plata
{ lat: -16.5000, lng: -68.1500, nome: mensagemAleatoria() }, // La Paz
{ lat: -53.1638, lng: -70.9171, nome: mensagemAleatoria() }, // Punta Arenas
{ lat: -0.1807, lng: -78.4678, nome: mensagemAleatoria() }, // Quito
{ lat: -12.0464, lng: -77.0428, nome: mensagemAleatoria() }, // Lima

{ lat: 48.2082, lng: 16.3738, nome: mensagemAleatoria() }, // Viena
{ lat: 50.8503, lng: 4.3517, nome: mensagemAleatoria() }, // Bruxelas
{ lat: 55.6761, lng: 12.5683, nome: mensagemAleatoria() }, // Copenhague
{ lat: 47.4979, lng: 19.0402, nome: mensagemAleatoria() }, // Budapeste
{ lat: 41.9028, lng: 12.4964, nome: mensagemAleatoria() }, // Roma (cidade)
{ lat: 43.7696, lng: 11.2558, nome: mensagemAleatoria() }, // Floren√ßa
{ lat: 35.8989, lng: 14.5146, nome: mensagemAleatoria() }, // Valeta - Malta
{ lat: 40.4168, lng: -3.7038, nome: mensagemAleatoria() }, // Madrid
{ lat: 45.4642, lng: 9.1900, nome: mensagemAleatoria() }, // Mil√£o
{ lat: 59.9139, lng: 10.7522, nome: mensagemAleatoria() }, // Oslo


    // Brasil
    { lat: -22.9519, lng: -43.2105, nome: mensagemAleatoria() },
    { lat: -22.9486, lng: -43.1566, nome: mensagemAleatoria() },
    { lat: -23.5614, lng: -46.6554, nome: mensagemAleatoria() },
    { lat: -12.9718, lng: -38.5108, nome: mensagemAleatoria() },
    { lat: -12.9730, lng: -38.5109, nome: mensagemAleatoria() },
    { lat: -8.1195, lng: -34.9033, nome: mensagemAleatoria() },
    { lat: -9.7696, lng: -35.8407, nome: mensagemAleatoria() },
    { lat: -13.0094, lng: -38.5324, nome: mensagemAleatoria() },
    { lat: -23.2192, lng: -44.7114, nome: mensagemAleatoria() },
    { lat: -2.5315, lng: -43.1142, nome: mensagemAleatoria() },

    // Natureza
    { lat: 36.1069, lng: -112.1129, nome: mensagemAleatoria() },
    { lat: -25.6953, lng: -54.4367, nome: mensagemAleatoria() },
    { lat: 28.0015, lng: 86.8528, nome: mensagemAleatoria() },
    { lat: 37.8651, lng: -119.5383, nome: mensagemAleatoria() },
    { lat: -15.7667, lng: -69.3333, nome: mensagemAleatoria() },
    { lat: -49.3315, lng: -72.8864, nome: mensagemAleatoria() },
    { lat: 63.8804, lng: -22.4495, nome: mensagemAleatoria() },
    { lat: 35.3606, lng: 138.7274, nome: mensagemAleatoria() },
    { lat: -13.1631, lng: -72.5450, nome: mensagemAleatoria() },
    { lat: -25.3444, lng: 131.0369, nome: mensagemAleatoria() },

    // Urbanos
    { lat: 36.1147, lng: -115.1728, nome: mensagemAleatoria() },
    { lat: 40.7851, lng: -73.9683, nome: mensagemAleatoria() },
    { lat: 43.6426, lng: -79.3871, nome: mensagemAleatoria() },
    { lat: -33.8568, lng: 151.2153, nome: mensagemAleatoria() },
    { lat: 55.7539, lng: 37.6208, nome: mensagemAleatoria() },
    { lat: 48.8606, lng: 2.3376, nome: mensagemAleatoria() },
    { lat: 35.6595, lng: 139.7005, nome: mensagemAleatoria() },
    { lat: 1.2834, lng: 103.8607, nome: mensagemAleatoria() },
    { lat: -34.6083, lng: -58.3629, nome: mensagemAleatoria() },
    { lat: -34.6037, lng: -58.3816, nome: mensagemAleatoria() },
	{ lat: 34.0522, lng: -118.2437, nome: mensagemAleatoria() },
	{ lat: 51.5074, lng: -0.1278, nome: mensagemAleatoria() },
	{ lat: 41.8781, lng: -87.6298, nome: mensagemAleatoria() },
	{ lat: 52.5200, lng: 13.4050, nome: mensagemAleatoria() },
	{ lat: 37.7749, lng: -122.4194, nome: mensagemAleatoria() },
	{ lat: 25.2048, lng: 55.2708, nome: mensagemAleatoria() },
	{ lat: 19.4326, lng: -99.1332, nome: mensagemAleatoria() },
	{ lat: 39.9042, lng: 116.4074, nome: mensagemAleatoria() },
	{ lat: -22.9068, lng: -43.1729, nome: mensagemAleatoria() },
	{ lat: -23.5505, lng: -46.6333, nome: mensagemAleatoria() },

	{ lat: 59.3293, lng: 18.0686, nome: mensagemAleatoria() },
	{ lat: 45.4642, lng: 9.1900, nome: mensagemAleatoria() },
	{ lat: 35.6762, lng: 139.6503, nome: mensagemAleatoria() },
	{ lat: 55.6761, lng: 12.5683, nome: mensagemAleatoria() },
	{ lat: 47.4979, lng: 19.0402, nome: mensagemAleatoria() },
	{ lat: 50.1109, lng: 8.6821, nome: mensagemAleatoria() },
	{ lat: 60.1699, lng: 24.9384, nome: mensagemAleatoria() },
	{ lat: -36.8485, lng: 174.7633, nome: mensagemAleatoria() },
	{ lat: 31.2304, lng: 121.4737, nome: mensagemAleatoria() },
	{ lat: 30.0444, lng: 31.2357, nome: mensagemAleatoria() }
];


    const timerDiv = document.getElementById("timer");
    const playTimerDiv = document.getElementById("playTimer");
    const btnApostar = document.getElementById("btnApostar");

    let startLat, startLng, startName;

   function iniciarPartida() {

    // limpa timers anteriores
    clearInterval(countdownInterval);
    clearInterval(zoomInterval);
    clearInterval(playTimerRef);

    timerDiv.style.display = "none";
    playTimerDiv.style.display = "none";
    btnApostar.style.display = "none";

    jogoAtivo = false;

    btnApostar.disabled = true;   // <--- DESABILITA O BOT√ÉO
    deuZoom = false;              // <--- RESET FLAG

    if (map) {
        map.remove();
    }

    const ponto = pontosTuristicos[Math.floor(Math.random() * pontosTuristicos.length)];
    startLat = ponto.lat;
    startLng = ponto.lng;
    startName = ponto.nome;

    map = L.map('map').setView([startLat, startLng], 18);

    L.tileLayer(
        'https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}',
        { maxZoom: 19 }
    ).addTo(map);

    marker = L.marker([startLat, startLng]).addTo(map);
    marker.bindPopup(startName).openPopup();

    // -----------------------
    // DETECTAR ZOOM MANUAL
    // -----------------------
    let ultimoZoom = map.getZoom();

    map.on("zoomend", function () {
        const novoZoom = map.getZoom();

        if (novoZoom > ultimoZoom) {
            deuZoom = true;
            btnApostar.disabled = false; // habilitado ap√≥s zoom manual
        }

        ultimoZoom = novoZoom;
    });

    iniciarTimerInicial();
}



    // ------------------------
    // Timer inicial (3s)
    // ------------------------
    function iniciarTimerInicial() {
        let countdown = 5;

        timerDiv.style.display = "block";
        timerDiv.innerText = countdown;

        countdownInterval = setInterval(() => {
            countdown--;
            timerDiv.innerText = countdown;

            if (countdown === 0) {
                clearInterval(countdownInterval);
                timerDiv.style.display = "none";
                marker.remove();
                iniciarZoomOut();
            }
        }, 1000);
    }


    // ------------------------
    // Zoom-Out
    // ------------------------
    function iniciarZoomOut() {
        let currentZoom = map.getZoom();
        const minZoom = 3;

        zoomInterval = setInterval(() => {
            currentZoom--;

            if (currentZoom < minZoom) {
                clearInterval(zoomInterval);
                iniciarTimerJogo();
            } else {
                map.setZoom(currentZoom);
            }
        }, 600);
    }


    // ------------------------
    // Timer da jogada (30s)
    // ------------------------
    function iniciarTimerJogo() {
        jogoAtivo = true;
        let timeLeft = 30;

        playTimerDiv.style.display = "block";
        playTimerDiv.innerText = timeLeft;

        btnApostar.style.display = "block";

        playTimerRef = setInterval(() => {
            timeLeft--;
            playTimerDiv.innerText = timeLeft;

            if (timeLeft <= 0) {
                clearInterval(playTimerRef);
                perder();
            }
        }, 1000);
    }


    // ------------------------
    // Clique no bot√£o ‚ÄúEsse √© o ponto!‚Äù
    // ------------------------
    btnApostar.addEventListener("click", () => {
    if (!jogoAtivo || !deuZoom) return;  // <--- impede clicar sem zoom
    clearInterval(playTimerRef);
    verificarPalpite();
});


    // ------------------------
    // Verifica palpite
    // ------------------------
  function verificarPalpite() {
    jogoAtivo = false;
    btnApostar.style.display = "none";
    playTimerDiv.style.display = "none";

    const center = map.getCenter();
    const distanciaMetros = map.distance([startLat, startLng], center);
    const distanciaKm = distanciaMetros / 1000;

    if (distanciaMetros <= 1000) {
        alert("üéâ Voc√™ acertou! Dist√¢ncia: " + distanciaKm.toFixed(2) + " km");
		definirMensagemHeader();
		document.getElementById("textoBotao").innerText = textoBotaoAleatorio();
    } else {
        alert("‚ùå N√£o foi dessa vez... Dist√¢ncia: " + distanciaKm.toFixed(2) + " km");
		definirMensagemHeader();
		document.getElementById("textoBotao").innerText =  textoBotaoAleatorio();
		
		
    }

    iniciarPartida(); // reinicia o jogo automaticamente
}


    // ------------------------
    // Perdeu pelo tempo
    // ------------------------
    function perder() {
        jogoAtivo = false;
        btnApostar.style.display = "none";
        playTimerDiv.style.display = "none";
        alert("‚è≥ Tempo acabou! Voc√™ perdeu.");

        iniciarPartida();
    }


    // ------------------------
    // IN√çCIO DO JOGO
    // ------------------------
    iniciarPartida();
	
	
	const headerMessages = [
    "Encontre o ponto secreto no mapa!",
    "Voc√™ sabe onde est√°?",
    "Descubra. Acerte. Ven√ßa.",
    "O desafio de localiza√ß√£o definitiva!",
    "Teste sua intui√ß√£o geogr√°fica!",
    "Prepare-se para ca√ßar locais pelo mundo!",
    "O mapa revela‚Ä¶ voc√™ encontra?",
    "Ser√° que voc√™ reconhece este lugar?",
    "Sua mente contra o planeta.",
    "S√≥ os bons acham üëÄ",
    "Manda ver, explorador!",
    "Um ponto aleat√≥rio. Uma chance de acertar.",
    "T√° perdido? Espero que n√£o!",
    "Encontre se for capaz.",
    "O mundo te espera.",
    "Zoom. Procure. Acerte.",
    "O jogo do mapa.",
    "Localize e ven√ßa."
];

const mensagensBotao = [
    "Esse √© o ponto!",
    "Aqui!",
    "Achei!",
    "√â aqui mesmo!",
    "Estou confiante!",
    "Chuta aqui!",
    "Minha aposta √© essa!",
    "√â esse o local!",
    "Marcar esse ponto!",
    "Confirmar palpite!",
    "Vai ser aqui!",
    "Tenho certeza!",
    "Vamos ver!",
    "Estou apostando aqui!",
    "Acho que √© aqui!",
    "Tentar este ponto!",
    "√â por aqui!",
    "Vou arriscar aqui!",
    "√â esse lugar!",
    "Achei o local!"
];


// Define mensagem aleat√≥ria no header
function definirMensagemHeader() {
    const texto = headerMessages[Math.floor(Math.random() * headerMessages.length)];
    document.getElementById("headerText").textContent = texto;
}

function textoBotaoAleatorio() {
    return mensagensBotao[Math.floor(Math.random() * mensagensBotao.length)];
}

// Executa ao carregar a p√°gina
definirMensagemHeader();

	
</script>

